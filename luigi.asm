; ------------------------------------------------------------------------------------------------------------
; Read a BMP file 320x200 and print it to screen
; Author: Barak Gonen, 2014
; Credit: Diego Escala, www.ece.msstate.edu/~reese/EE3724/labs/lab9/bitmap.asm
; -------------------------------------------------------------------------------------------------------------
IDEAL
MODEL small
STACK 100h
DATASEG
filename db 'intro.bmp',0
filehandle dw ?
Header db 54 dup (0)
Palette db 256*4 dup (0)
ScrLine db 320 dup (0)
ErrorMsg db 'Error', 13, 10,'$'

timer dw 0ffffh
; -------------------------------------------------------------------------------------------------------------
static 	db 227,227,227,227,227,73,32,32,32,32,73,227,227,227,227,227
		db 227,227,227,227,73,32,28,28,28,105,32,73,227,227,227,227
		db 227,227,227,227,32,20,28,28,28,73,73,32,227,227,227,227
		db 227,227,227,73,32,28,28,28,28,20,73,28,32,73,227,227
		db 227,73,32,32,28,28,28,28,20,16,28,28,20,32,227,227
		db 73,32,20,60,28,60,28,20,28,28,28,16,32,73,227,227
		db 32,16,28,28,28,20,20,28,28,20,73,32,73,227,227,227
		db 32,20,16,20,20,20,20,20,73,73,73,32,227,227,227,227
		db 32,20,16,20,20,16,73,73,178,73,105,32,227,227,227,227
		db 73,32,20,20,73,40,73,73,255,255,73,32,227,227,227,227
		db 227,32,73,73,72,73,73,77,73,73,109,132,32,73,227,227
		db 227,73,32,254,249,240,132,250,250,250,254,255,254,32,73,227
		db 227,227,32,249,254,254,249,254,132,254,254,254,254,250,32,227
		db 227,227,73,32,249,254,254,254,100,132,249,254,250,249,32,227
		db 227,227,227,32,132,245,249,254,100,32,240,249,248,32,73,227
		db 227,227,227,73,32,132,249,249,132,32,32,32,32,73,227,227
		db 227,227,227,32,132,104,204,249,249,132,32,73,227,227,227,227
		db 227,227,32,20,20,20,20,240,240,32,73,227,227,227,227,227
		db 227,227,227,32,32,32,20,20,20,32,227,227,227,227,227,227
		db 227,227,227,227,73,32,73,41,69,32,73,227,227,227,227,227
		db 227,227,227,227,32,72,105,32,73,73,32,227,227,227,227,227
		db 227,227,227,227,32,73,73,32,73,41,32,227,227,227,227,227
		db 227,227,227,73,32,105,73,32,73,72,32,73,227,227,227,227
		db 227,227,227,32,105,105,77,32,219,146,32,32,227,227,227,227
		db 227,227,73,32,73,73,73,219,219,219,219,32,73,227,227,227
		db 227,227,32,41,105,105,219,146,219,219,146,73,32,227,227,227
		db 227,227,32,73,73,73,178,146,146,146,114,72,32,227,227,227
		db 227,227,73,32,73,73,73,146,146,146,73,73,32,227,227,227
		db 227,227,227,73,32,32,32,73,40,73,73,41,32,227,227,227
		db 227,227,227,227,32,100,100,100,100,100,172,32,73,227,227,227
		db 227,227,227,227,73,32,73,105,73,73,32,73,227,227,227,227
		db 227,227,227,227,227,32,73,73,73,32,73,227,227,227,227,227
		db 227,227,227,227,227,32,73,73,41,32,227,227,227,227,227,227
		db 227,227,227,227,73,32,73,72,68,32,73,227,227,227,227,227
		db 227,227,227,73,32,73,73,146,146,146,32,73,227,227,227,227
		db 227,227,227,32,146,178,146,146,146,146,146,32,227,227,227,227
		db 227,227,227,32,146,146,146,146,146,146,146,32,227,227,227,227
		db 227,227,227,73,32,145,146,146,146,146,32,73,227,227,227,227
		db 227,227,227,227,73,32,32,32,32,32,73,227,227,227,227,227

; -------------------------------------------------------------------------------------------------------------
run1 	db 227,227,227,227,227,227,227,227,227,227,227,227,227,227,227,227
		db 227,227,227,227,227,73,32,32,32,32,73,227,227,227,227,227
		db 227,227,227,227,73,32,28,28,28,105,32,73,227,227,227,227
		db 227,227,227,227,32,20,28,28,28,41,73,32,227,227,227,227
		db 227,227,227,73,32,28,28,28,28,20,72,28,32,73,227,227
		db 227,105,32,32,28,28,28,28,20,20,28,60,20,32,227,227
		db 73,32,20,28,28,28,28,20,28,60,28,16,32,73,227,227
		db 32,16,28,28,60,20,20,28,28,20,41,32,73,227,227,227
		db 32,20,20,20,20,20,20,20,73,72,73,32,227,227,227,227
		db 32,20,16,20,20,20,73,73,146,73,73,32,227,227,227,227
		db 73,32,20,20,73,73,73,77,255,255,73,32,227,227,227,227
		db 227,32,73,73,69,73,73,73,105,73,105,132,32,105,227,227
		db 227,73,32,250,249,240,132,254,254,254,254,255,254,32,73,227
		db 227,227,32,249,254,254,249,254,132,250,254,254,254,254,32,227
		db 227,227,73,32,249,254,254,254,132,100,249,254,254,249,32,227
		db 227,227,227,32,132,249,245,254,132,32,240,244,249,32,73,227
		db 227,227,227,73,32,132,249,245,132,32,32,32,32,73,227,227
		db 227,227,227,32,132,132,172,249,249,100,32,73,227,227,227,227
		db 227,227,32,20,20,20,16,240,240,32,73,227,227,227,227,227
		db 227,32,20,32,32,32,20,20,20,32,227,227,227,227,227,227
		db 227,227,32,32,32,32,73,105,73,32,227,227,227,227,227,227
		db 227,227,227,227,227,32,73,73,72,32,73,227,227,227,227,227
		db 227,227,227,227,73,32,73,73,32,73,32,32,73,227,227,227
		db 227,227,227,227,32,105,77,73,32,73,219,146,32,73,227,227
		db 227,227,227,73,32,73,105,73,73,219,219,219,219,32,227,227
		db 227,227,227,32,77,73,73,73,219,146,219,219,178,32,227,227
		db 227,227,227,32,73,105,105,41,219,146,219,146,146,32,227,227
		db 227,227,227,32,41,73,73,73,73,146,178,146,32,73,227,227
		db 227,227,227,73,32,32,32,32,32,73,73,73,32,227,227,227
		db 227,227,227,227,32,77,77,41,41,73,73,32,73,227,227,227
		db 227,227,227,227,32,100,100,100,100,100,172,32,227,227,227,227
		db 227,227,227,73,32,73,105,73,77,73,32,73,227,227,227,227
		db 227,73,32,32,73,73,73,73,73,32,32,73,227,227,227,227
		db 73,32,146,178,77,73,73,73,32,32,146,32,73,227,227,227
		db 32,146,178,146,73,73,73,32,32,146,146,146,32,227,227,227
		db 32,145,146,146,146,73,32,146,146,150,146,146,32,227,227,227
		db 73,32,146,146,146,146,178,32,146,146,146,32,73,227,227,227
		db 227,73,32,146,146,146,114,32,32,32,32,73,227,227,227,227
		db 227,227,73,32,32,32,32,73,227,227,227,227,227,227,227,227

; -------------------------------------------------------------------------------------------------------------
run2 	db 227,227,227,227,227,227,227,227,227,227,227,227,227,227,227,227
		db 227,227,227,227,227,227,227,227,227,227,227,227,227,227,227,227
		db 227,227,227,227,227,73,32,32,32,32,73,227,227,227,227,227
		db 227,227,227,227,73,32,28,60,28,73,32,73,227,227,227,227
		db 227,227,227,227,32,20,28,28,28,72,105,32,227,227,227,227
		db 227,227,227,73,32,28,28,28,28,20,73,28,32,73,227,227
		db 227,73,32,32,28,28,28,28,20,16,28,28,20,32,227,227
		db 73,32,20,28,60,28,28,20,28,28,28,20,32,73,227,227
		db 32,20,28,28,28,20,20,28,28,20,73,32,73,227,227,227
		db 32,20,20,16,20,20,20,20,73,68,73,32,227,227,227,227
		db 32,20,20,20,20,20,73,73,146,73,73,32,227,227,227,227
		db 73,32,20,16,73,72,73,105,255,255,73,32,227,227,227,227
		db 227,32,73,73,41,105,73,73,73,105,73,132,32,73,227,227
		db 227,73,32,254,249,240,132,254,254,254,254,255,254,32,73,227
		db 227,227,32,245,254,254,249,254,132,254,254,250,254,254,32,227
		db 227,227,73,32,249,250,254,254,132,132,249,254,254,249,32,227
		db 227,227,227,32,132,249,249,254,100,32,240,249,249,32,73,227
		db 227,227,227,73,32,132,245,249,132,32,32,32,32,73,227,227
		db 227,227,227,32,132,132,204,245,249,100,32,73,227,227,227,227
		db 227,227,32,73,32,32,16,240,240,32,73,227,227,227,227,227
		db 227,227,227,32,32,73,20,20,20,32,227,227,227,227,227,227
		db 227,227,32,20,20,20,73,73,16,32,227,227,227,227,227,227
		db 227,227,227,32,32,32,105,105,72,32,73,32,32,32,73,227
		db 227,227,227,227,227,32,73,77,32,73,32,219,219,146,32,73
		db 227,227,227,227,73,32,105,73,73,73,146,219,219,219,178,32
		db 227,227,227,227,32,77,73,73,73,105,219,150,219,146,146,32
		db 227,227,227,227,32,73,73,73,73,105,73,146,178,146,32,73
		db 227,227,227,227,32,105,73,73,73,73,73,146,146,32,73,227
		db 227,227,227,227,32,73,32,73,72,32,32,32,32,73,227,227
		db 227,227,227,227,32,105,72,32,32,32,73,32,73,227,227,227
		db 227,227,227,73,32,100,100,100,100,100,172,32,32,227,227,227
		db 227,73,32,32,73,73,73,105,73,73,32,73,32,32,73,227
		db 73,32,146,178,73,73,73,73,73,32,41,73,73,146,32,73
		db 32,146,178,72,73,73,72,32,32,69,73,73,146,178,146,32
		db 32,146,150,73,73,73,32,73,32,73,73,150,146,146,146,32
		db 32,142,146,146,73,32,73,227,32,150,146,146,146,146,32,73
		db 32,146,146,146,146,32,227,227,73,32,146,145,32,32,73,227
		db 73,32,141,146,146,32,227,227,227,73,32,32,73,227,227,227
		db 227,73,32,32,32,73,227,227,227,227,227,227,227,227,227,227

; -------------------------------------------------------------------------------------------------------------
run3	db 227,227,227,227,227,227,227,227,227,227,227,227,227,227,227,227
		db 227,227,227,227,227,73,32,32,32,32,73,227,227,227,227,227
		db 227,227,227,227,73,32,28,28,28,105,32,73,227,227,227,227
		db 227,227,227,227,32,20,28,28,28,41,73,32,227,227,227,227
		db 227,227,227,73,32,28,28,28,28,20,72,28,32,73,227,227
		db 227,105,32,32,28,28,28,28,20,20,28,60,20,32,227,227
		db 73,32,20,28,28,28,28,20,28,60,28,16,32,73,227,227
		db 32,16,28,28,60,20,20,28,28,20,41,32,73,227,227,227
		db 32,20,20,20,20,20,20,20,73,72,73,32,227,227,227,227
		db 32,20,16,20,20,20,73,73,146,73,73,32,227,227,227,227
		db 73,32,20,20,73,73,73,77,255,255,73,32,227,227,227,227
		db 227,32,73,73,69,73,73,73,105,73,105,132,32,105,227,227
		db 227,73,32,250,249,240,132,254,254,254,254,255,254,32,73,227
		db 227,227,32,249,254,254,249,254,132,250,254,254,254,254,32,227
		db 227,227,73,32,249,254,254,254,132,100,249,254,254,249,32,227
		db 227,227,227,32,132,249,245,254,132,32,240,244,249,32,73,227
		db 227,227,227,73,32,100,249,249,132,32,32,32,32,73,227,227
		db 227,227,227,32,132,132,204,249,249,100,32,73,227,227,227,227
		db 227,227,32,20,20,16,20,240,240,32,73,227,227,227,227,227
		db 227,32,16,32,32,32,20,20,20,32,227,227,227,227,227,227
		db 227,227,32,32,32,105,105,77,73,32,227,227,227,227,227,227
		db 227,227,227,227,73,32,73,73,72,32,73,227,227,227,227,227
		db 227,227,227,227,32,73,73,105,32,73,32,32,73,227,227,227
		db 227,227,227,73,32,105,73,73,32,73,219,146,32,73,227,227
		db 227,227,227,32,73,73,73,105,73,219,219,146,219,32,227,227
		db 227,227,227,32,73,105,73,73,219,146,219,219,178,32,227,227
		db 227,227,227,32,73,105,77,73,219,146,219,146,109,32,227,227
		db 227,227,227,73,32,41,69,73,72,146,146,146,32,73,227,227
		db 227,227,227,73,32,32,32,32,32,73,72,32,73,227,227,227
		db 227,227,73,32,100,100,100,100,100,100,172,32,227,227,227,227
		db 227,73,32,113,178,73,105,105,109,72,32,32,227,227,227,227
		db 227,32,146,146,146,73,73,41,41,32,73,32,227,227,227,227
		db 73,32,146,146,73,73,73,32,32,73,73,32,227,227,227,227
		db 64,145,146,146,73,72,32,32,73,72,73,32,73,227,227,227
		db 32,146,146,178,146,146,32,32,41,72,146,146,32,73,227,227
		db 73,32,113,146,146,32,32,146,178,178,146,178,146,32,227,227
		db 227,73,32,32,32,73,32,114,146,146,146,146,146,32,227,227
		db 227,227,227,227,227,227,73,32,146,145,146,146,32,73,227,227
		db 227,227,227,227,227,227,227,73,32,32,32,32,73,227,227,227

; -------------------------------------------------------------------------------------------------------------
run4	db 227,227,227,227,227,73,32,32,32,32,73,227,227,227,227,227
		db 227,227,227,227,73,32,28,28,28,105,32,73,227,227,227,227
		db 227,227,227,227,32,20,28,28,28,73,73,32,227,227,227,227
		db 227,227,227,73,32,28,28,28,28,20,73,28,32,73,227,227
		db 227,73,32,32,28,28,28,28,20,16,28,28,20,32,227,227
		db 73,32,20,60,28,60,28,20,28,28,28,16,32,73,227,227
		db 32,16,28,28,28,20,20,28,28,20,73,32,73,227,227,227
		db 32,20,16,20,20,20,20,20,73,73,73,32,227,227,227,227
		db 32,20,16,20,20,16,73,73,178,73,105,32,227,227,227,227
		db 73,32,20,20,73,40,73,73,255,255,73,32,227,227,227,227
		db 227,32,73,73,72,73,73,77,73,73,109,132,32,73,227,227
		db 227,73,32,254,249,240,132,250,250,250,254,255,254,32,73,227
		db 227,227,32,249,254,254,249,254,132,254,254,254,254,250,32,227
		db 227,227,73,32,249,254,254,254,100,132,249,254,250,249,32,227
		db 227,227,227,32,132,245,249,254,100,32,240,249,248,32,73,227
		db 227,227,227,73,32,132,249,249,132,32,32,32,32,73,227,227
		db 227,227,227,32,132,100,204,249,249,100,32,73,227,227,227,227
		db 227,227,32,20,16,20,20,240,240,32,73,227,227,227,227,227
		db 227,32,16,32,32,32,20,20,20,32,227,227,227,227,227,227
		db 227,227,32,32,73,32,69,73,73,32,73,227,227,227,227,227
		db 227,227,227,227,32,73,73,32,73,73,32,227,227,227,227,227
		db 227,227,227,227,32,73,73,32,73,41,32,227,227,227,227,227
		db 227,227,227,73,32,73,77,32,73,69,32,73,227,227,227,227
		db 227,227,227,32,73,109,73,32,219,146,73,32,227,227,227,227
		db 227,227,73,32,73,105,73,219,219,219,219,32,73,227,227,227
		db 227,227,32,41,105,73,219,146,219,219,146,73,32,227,227,227
		db 227,227,32,73,73,73,146,146,146,146,114,72,32,227,227,227
		db 227,227,73,32,73,73,72,146,146,146,73,73,32,227,227,227
		db 227,227,227,73,32,32,32,73,40,73,73,41,32,227,227,227
		db 227,227,227,227,32,100,100,100,100,100,172,32,73,227,227,227
		db 227,227,227,227,73,32,73,105,73,73,32,73,227,227,227,227
		db 227,227,227,227,227,32,73,73,73,32,73,227,227,227,227,227
		db 227,227,227,227,227,32,73,73,41,32,227,227,227,227,227,227
		db 227,227,227,227,73,32,73,72,68,32,73,227,227,227,227,227
		db 227,227,227,73,32,73,73,146,146,146,32,73,227,227,227,227
		db 227,227,227,32,146,178,146,146,146,146,146,32,227,227,227,227
		db 227,227,227,32,146,146,146,146,146,146,146,32,227,227,227,227
		db 227,227,227,73,32,145,146,146,146,146,32,73,227,227,227,227
		db 227,227,227,227,73,32,32,32,32,32,73,227,227,227,227,227

; -------------------------------------------------------------------------------------------------------------
run5	db 227,227,227,227,227,227,227,227,227,227,227,227,227,227,227,227
		db 227,227,227,227,227,73,32,32,32,32,73,227,227,227,227,227
		db 227,227,227,227,73,32,28,28,28,105,32,73,227,227,227,227
		db 227,227,227,227,32,20,28,28,28,41,73,32,227,227,227,227
		db 227,227,227,73,32,28,28,28,28,20,72,28,32,73,227,227
		db 227,105,32,32,28,28,28,28,20,20,28,60,20,32,227,227
		db 73,32,20,28,28,28,28,20,28,60,28,16,32,73,227,227
		db 32,16,28,28,60,20,20,28,28,20,41,32,73,227,227,227
		db 32,20,20,20,20,20,20,20,73,72,73,32,227,227,227,227
		db 32,20,16,20,20,20,73,73,146,73,73,32,227,227,227,227
		db 73,32,20,20,73,73,73,77,255,255,73,32,227,227,227,227
		db 227,32,73,73,69,73,73,73,105,73,105,132,32,105,227,227
		db 227,73,32,250,249,240,132,254,254,254,254,255,254,32,73,227
		db 227,227,32,249,254,254,249,254,132,250,254,254,254,254,32,227
		db 227,227,73,32,249,254,254,254,132,100,249,254,254,249,32,227
		db 227,227,227,32,132,249,245,254,132,32,240,244,249,32,73,227
		db 227,227,227,73,32,100,249,249,132,32,32,32,32,73,227,227
		db 227,227,227,32,100,132,204,249,249,132,32,73,227,227,227,227
		db 227,227,32,20,20,20,20,240,240,32,73,227,227,227,227,227
		db 227,32,20,32,32,32,16,20,20,32,73,227,227,227,227,227
		db 227,227,32,32,73,32,73,73,73,32,32,73,227,227,227,227
		db 227,227,227,73,32,73,72,32,72,32,32,32,73,227,227,227
		db 227,227,73,32,105,77,69,32,32,73,32,73,32,73,227,227
		db 227,227,32,73,73,77,73,73,32,73,73,146,146,32,73,227
		db 227,73,32,73,73,73,219,219,32,249,73,72,146,146,32,227
		db 227,32,73,73,73,219,219,219,219,172,172,73,146,145,32,227
		db 227,32,73,73,219,146,219,219,178,72,136,77,114,32,73,227
		db 227,73,73,72,146,178,219,146,145,73,105,105,32,73,227,227
		db 227,227,73,32,73,146,178,145,73,73,77,32,73,227,227,227
		db 227,227,227,73,32,100,100,100,100,100,172,32,227,227,227,227
		db 227,227,227,227,32,73,69,73,41,73,73,32,227,227,227,227
		db 227,227,227,227,32,32,73,72,105,73,73,32,227,227,227,227
		db 227,227,227,73,32,73,32,73,105,73,73,32,32,73,227,227
		db 227,227,73,32,150,73,32,73,77,73,146,150,146,32,73,227
		db 227,227,32,146,146,73,32,72,73,178,146,146,178,146,32,227
		db 227,227,32,146,146,146,32,73,146,146,146,146,109,146,32,227
		db 227,227,73,32,146,146,32,146,146,146,109,114,146,32,105,227
		db 227,227,227,105,32,32,32,32,146,146,113,32,32,73,227,227
		db 227,227,227,227,227,227,227,73,32,32,32,73,227,227,227,227

; -------------------------------------------------------------------------------------------------------------
run6	db 227,227,227,227,227,227,227,227,227,227,227,227,227,227,227,227
		db 227,227,227,227,227,227,227,227,227,227,227,227,227,227,227,227
		db 227,227,227,227,227,73,32,32,32,32,73,227,227,227,227,227
		db 227,227,227,227,73,32,28,60,28,73,32,73,227,227,227,227
		db 227,227,227,227,32,20,28,28,28,72,105,32,227,227,227,227
		db 227,227,227,73,32,28,28,28,28,20,73,28,32,73,227,227
		db 227,73,32,32,28,28,28,28,20,16,28,28,20,32,227,227
		db 73,32,20,28,60,28,28,20,28,28,28,20,32,73,227,227
		db 32,20,28,28,28,20,20,28,28,20,73,32,73,227,227,227
		db 32,20,20,16,20,20,20,20,73,68,73,32,227,227,227,227
		db 32,20,20,20,20,20,73,73,146,73,73,32,227,227,227,227
		db 73,32,20,16,73,72,73,105,255,255,73,32,227,227,227,227
		db 227,32,73,73,41,105,73,73,73,105,73,132,32,73,227,227
		db 227,73,32,254,249,240,132,254,254,254,254,255,254,32,73,227
		db 227,227,32,245,254,254,249,254,132,254,254,250,254,254,32,227
		db 227,227,73,32,249,250,254,254,132,132,249,254,254,249,32,227
		db 227,227,227,32,132,249,249,254,132,32,240,249,249,32,73,227
		db 227,227,227,73,32,132,245,249,100,32,32,32,32,73,227,227
		db 227,227,32,32,132,100,204,249,248,132,32,73,227,227,227,227
		db 227,32,32,20,20,20,20,240,240,32,73,227,227,227,227,227
		db 227,227,32,32,32,32,20,20,20,32,73,227,227,227,227,227
		db 227,227,73,32,72,73,69,72,73,32,32,73,32,32,73,227
		db 227,73,32,73,41,72,32,41,73,32,73,32,178,146,32,73
		db 227,32,73,105,77,73,32,73,73,32,32,73,146,146,178,32
		db 73,32,77,73,73,73,32,73,73,72,32,145,146,146,146,32
		db 32,73,73,178,219,219,32,172,249,105,73,240,146,146,114,32
		db 32,73,178,219,219,219,219,172,172,73,73,172,146,146,32,73
		db 32,73,219,219,219,219,146,136,136,77,73,136,32,32,73,227
		db 73,32,146,219,219,178,146,73,73,105,73,73,32,73,227,227
		db 227,73,32,178,146,146,41,73,77,73,73,32,32,32,73,227
		db 227,227,227,73,32,100,100,100,100,172,73,109,146,150,32,73
		db 227,73,32,32,32,32,73,73,73,73,146,146,146,146,146,32
		db 73,32,146,146,73,32,41,73,73,105,146,146,77,109,109,32
		db 32,142,146,73,73,73,32,73,73,146,146,109,146,142,32,73
		db 32,114,146,73,40,73,32,32,73,146,146,114,146,146,32,227
		db 32,146,178,146,73,32,32,73,32,146,146,178,146,32,73,227
		db 73,32,146,178,146,32,73,227,32,146,146,146,32,73,227,227
		db 227,32,146,146,150,32,227,227,73,32,32,32,73,227,227,227
		db 227,73,32,32,32,73,227,227,227,227,227,227,227,227,227,227

; -------------------------------------------------------------------------------------------------------------
run7	db 227,227,227,227,227,227,227,227,227,227,227,227,227,227,227,227
		db 227,227,227,227,227,73,32,32,32,32,73,227,227,227,227,227
		db 227,227,227,227,73,32,28,28,28,105,32,73,227,227,227,227
		db 227,227,227,227,32,20,28,28,28,41,73,32,227,227,227,227
		db 227,227,227,73,32,28,28,28,28,20,72,28,32,73,227,227
		db 227,105,32,32,28,28,28,28,20,20,28,60,20,32,227,227
		db 73,32,20,28,28,28,28,20,28,60,28,16,32,73,227,227
		db 32,16,28,28,60,20,20,28,28,20,41,32,73,227,227,227
		db 32,20,20,20,20,20,20,20,73,72,73,32,227,227,227,227
		db 32,20,16,20,20,20,73,73,146,73,73,32,227,227,227,227
		db 73,32,20,20,73,73,73,77,255,255,73,32,227,227,227,227
		db 227,32,73,73,69,73,73,73,105,73,105,132,32,105,227,227
		db 227,73,32,250,249,240,132,254,254,254,254,255,254,32,73,227
		db 227,227,32,249,254,254,249,254,132,250,254,254,254,254,32,227
		db 227,227,73,32,249,254,254,254,132,100,249,254,254,249,32,227
		db 227,227,227,32,132,249,245,254,132,32,240,244,249,32,73,227
		db 227,227,227,73,32,132,249,245,132,32,32,32,32,73,227,227
		db 227,227,227,32,132,132,204,249,249,132,32,73,227,227,227,227
		db 227,227,32,20,20,20,20,240,244,32,72,227,227,227,227,227
		db 227,32,16,32,32,32,20,20,20,32,73,227,227,227,227,227
		db 227,227,32,32,73,32,73,32,73,32,32,73,227,227,227,227
		db 227,227,227,73,32,41,73,32,73,32,41,32,73,227,227,227
		db 227,227,73,32,77,73,73,73,32,73,32,73,32,73,227,227
		db 227,73,32,73,105,73,73,73,32,73,73,32,182,32,73,227
		db 227,32,73,73,73,73,219,219,32,249,72,32,32,182,32,227
		db 227,32,105,73,73,219,219,219,219,109,172,72,32,32,32,227
		db 227,32,73,73,219,146,219,219,146,109,108,73,73,32,73,227
		db 227,73,32,40,150,146,219,146,109,73,105,73,32,73,227,227
		db 227,227,73,32,32,146,146,146,73,105,73,32,73,227,227,227
		db 227,227,73,32,32,73,100,100,100,100,172,32,227,227,227,227
		db 227,73,32,146,146,32,73,73,73,77,73,32,227,227,227,227
		db 227,32,146,146,146,73,32,72,73,73,73,32,227,227,227,227
		db 73,32,146,146,73,73,73,32,73,73,73,32,227,227,227,227
		db 32,146,146,178,72,73,73,32,73,73,73,32,73,227,227,227
		db 32,146,146,146,146,150,32,32,41,73,146,146,32,73,227,227
		db 73,32,146,146,178,32,32,146,146,178,146,178,146,32,227,227
		db 227,73,32,32,32,73,32,146,146,146,146,146,146,32,227,227
		db 227,227,227,227,227,227,73,32,146,145,145,146,32,73,227,227
		db 227,227,227,227,227,227,227,73,32,32,32,32,73,227,227,227

; -------------------------------------------------------------------------------------------------------------
temp db 624 dup (0)

; -------------------------------------------------------------------------------------------------------------

CODESEG
	; -------------------------------------------------------------------------------------------------------------
	proc OpenFile
	; Open file
	mov ah, 3Dh
	xor al, al
	mov dx, offset filename
	int 21h
	jc openerror
	mov [filehandle], ax

	ret
	openerror:
	mov dx, offset ErrorMsg
	mov ah, 9h
	int 21h
	ret
	endp OpenFile

	proc ReadHeader
	; Read BMP file header, 54 bytes
	mov ah,3fh
	mov bx, [filehandle]
	mov cx,54
	mov dx,offset Header
	int 21h
	ret
	endp ReadHeader


	proc ReadPalette
	; Read BMP file color palette, 256 colors * 4 bytes (400h)
	mov ah,3fh
	mov cx,400h
	mov dx,offset Palette
	int 21h
	ret
	endp ReadPalette

	proc CopyPal
	; Copy the colors palette to the video memory
	; The number of the first color should be sent to port 3C8h
	; The palette is sent to port 3C9h
	mov si,offset Palette
	mov cx,256
	mov dx,3C8h
	mov al,0
	; Copy starting color to port 3C8h
	out dx,al
	; Copy palette itself to port 3C9h
	inc dx
	PalLoop:
	; Note: Colors in a BMP file are saved as BGR values rather than RGB.
	mov al,[si+2] ; Get red value.
	shr al,2 ; Max. is 255, but video palette maximal
	; value is 63. Therefore dividing by 4.
	out dx,al ; Send it.
	mov al,[si+1] ; Get green value.
	shr al,2
	out dx,al ; Send it.
	mov al,[si] ; Get blue value.
	shr al,2
	out dx,al ; Send it.
	add si,4 ; Point to next color.
	; (There is a null chr. after every color.)

	loop PalLoop
	ret
	endp CopyPal


	proc CopyBitmap
	; BMP graphics are saved upside-down.
	; Read the graphic line by line (200 lines in VGA format),
	; displaying the lines from bottom to top.
	mov ax, 0A000h
	mov es, ax
	mov cx,200
	PrintBMPLoop:
	push cx
	; di = cx*320, point to the correct screen line
	mov di,cx
	shl cx,6    ;*64
	shl di,8    ;*256  ;       256+64 = 320
	add di,cx
	; Read one line to variable ScrLine (buffer)
	mov ah,3fh  
	mov cx,320
	mov dx,offset ScrLine
	int 21h
	; Copy one line into video memory
	cld ; Clear direction flag, for movsb for inc si, inc di
	mov cx,320
	mov si,offset ScrLine

	rep movsb ; Copy line to the screen
	 ;rep movsb is same as the following code:
	 ;mov es:di, ds:si
	 ;inc si
	 ;inc di
	 ;dec cx
	 ;loop until cx=0
	pop cx
	loop PrintBMPLoop
	ret
	endp CopyBitmap
; -------------------------------------------------------------------------------------------------------------
proc openbmp
push ax
push bx
push cx
push dx
push si
push di

	call OpenFile
	call ReadHeader
	call ReadPalette
	call CopyPal
	call CopyBitmap
pop di
pop si
pop dx
pop cx
pop bx
pop ax
ret
endp openbmp
; -------------------------------------------------------------------------------------------------------------
;input - none
;output - es:0ffffh
;makes a timer of 1 second in es:0ffffh
proc delay1sec
push cx
push dx
push ax
push bx

	mov dx,4240h
	mov cx,0Fh
	mov bx,0ffffh
	mov [byte ptr es:bx],0
	mov ax,8300H
	int 15h

pop bx
pop ax
pop dx
pop cx
ret
endp delay1sec
; -------------------------------------------------------------------------------------------------------------
;input - bp+4 location of the upper left pixel colour, bp+6 the location of the upper left pixel on the screen
;output - es: 0 - 63999 
;prints a frame on the screen
proc movement
push bp
mov bp,sp
push bx
push cx
push ax
push di
push si

	mov si,[bp+4]
	mov di,[bp+6]
	mov bx,di
	add bx,16
	mov cx,39
	sameline:
	mov al,[si]
	cmp al,227
	je skip
		mov [es:di],al
	skip:
	inc si
	inc di
	cmp bx,di
	jne sameline
	sub di,16
	add di,320
	mov bx,di
	add bx,16
	loop sameline
		
pop si
pop di
pop ax
pop cx
pop bx
pop bp
ret
endp movement
; -------------------------------------------------------------------------------------------------------------
;input - bp+4 location of the upper left pixel colour, bp+6 the location of the upper left pixel on the screen
;output - ds:temp
;copys a frame from the screen
proc copy 
push bp
mov bp,sp
push bx
push cx
push ax
push di
push si

	mov si,[bp+4]
	mov di,[bp+6]
	mov bx,di
	add bx,16
	mov cx,39
	sameline1:
		mov al,[es:di]
		mov [si],al
	inc si
	inc di
	cmp bx,di
	jne sameline1
	sub di,16
	add di,320
	mov bx,di
	add bx,16
	loop sameline1
		
pop si
pop di
pop ax
pop cx
pop bx
pop bp
ret
endp copy
; -------------------------------------------------------------------------------------------------------------
;input - bp+4 frame, bp+6 location of the upper left pixel, bp+8 temp
;output - ds:temp, es: 0 - 63999 
;copys a frame from the screen and prints in the same location a frame
proc copypaste
push bp
mov bp,sp
push bx
push si

push [bp+6]		;location
push [bp+8]		;temp
	call copy
	
pop si


push [bp+4]		;frame
	call movement

pop si
pop si

pop si
pop bx
pop bp
ret
endp copypaste
; -------------------------------------------------------------------------------------------------------------
;input - bp+6 location of the upper left pixel, bp+8 temp
;output - es: 0 - 63999 
;prints the background where the frame was
proc delete
push bp
push si

	push [bp+6]		;location
	push [bp+8]		;temp
	call movement
	
pop si
pop si

pop si	
pop bp
ret
endp delete
; -------------------------------------------------------------------------------------------------------------
proc delay1
push cx
push bx

	mov cx,9999h
	hiii:
		xor bx,bx
		hii:
			inc bx
			cmp bx,50h
		jnz hii
	loop hiii

pop bx
pop cx
ret
endp delay1
; -------------------------------------------------------------------------------------------------------------
start:
mov ax, @data
mov ds, ax
; Graphic mode
mov ax, 13h
int 10h
call openbmp
waitforstart:
	mov ah,1
	int 16h
je waitforstart
	mov ah,0
	int 16h
	
mov si,offset filename
mov [byte ptr si], 'b'
mov [byte ptr si+1], 'a'
mov [byte ptr si+2], 'c'
mov [byte ptr si+3], 'k'
mov [byte ptr si+4], '1'
call openbmp

mov bx,32000
push bx
push offset static
call movement
pop si
pop si

waitforstart1:
	mov ah,1
	int 16h
je waitforstart1

; Back to text mode
mov ah, 0
mov al, 2
int 10h
exit:
mov ax, 4c00h
int 21h
END start